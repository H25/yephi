// Generated by CoffeeScript 1.4.0
(function() {

  $(function() {
    $('search').typeahead({
      minLength: 1,
      items: 10,
      source: function(query, process) {
        return $.get('/s', {
          q: query
        }, function(data) {
          return process(data);
        }, 'json');
      }
    });
    $('#id_birthday').datepicker({
      changeYear: true,
      changeMonth: true,
      defaultDate: -(18 * 365)
    });
    $('#id_comment').keyup(function() {
      var text;
      text = $(this).val;
      if (text === '' || text.length > 300 || text === "Write your review about this movie here" || text === "Leave your comment here") {
        $('.submit-post').attr('disable', true);
        if (text.length > 300) {
          return $(this).css('background', '#E3596B');
        }
      } else {
        return $('.submit-post').attr('disable', false);
      }
    });
    $('#id_comment').focus(function() {
      if ($(this).val() === "Write your review about this movie here" || $(this).val() === "Leave your comment here") {
        return $(this).val('');
      }
    });
    $('#edit-review').click(function() {
      return $('#edit-review-dialog').dialog({
        title: 'Edit your review',
        show: 'drop',
        modal: true
      });
    });
    $('#new-movies-btn').click(function() {
      return $('#new-movies').slideDown();
    });
    $('.js-addToFavList').click(function(e) {
      var idPair, movieId, userId;
      e.preventDefault();
      idPair = $(this).attr('id').replace('movie_', '').split('_');
      console.log(idPair);
      movieId = idPair[0];
      userId = idPair[1];
      return $.ajax({
        url: '/favorite/add',
        type: 'GET',
        data: {
          user_id: userId,
          movie_id: movieId
        },
        success: function(resp) {
          if (resp.result === 'Added successfully') {
            return alert('Added');
          }
        }
      });
    });
    return true;
  });

}).call(this);
